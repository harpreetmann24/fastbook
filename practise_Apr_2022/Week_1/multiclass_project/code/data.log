[IPKernelApp] Exception in execute Exception ignored in: <function tqdm.__del__ at 0x1465ab511550>
Traceback (most recent call last):
  File "/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/tqdm/std.py", line 1161, in __del__
    def __del__(self):
KeyboardInterrupt: 
  1[0m [38;5;66;03m#df_raw['text'] = df_raw['Body'].swifter.apply(lambda x: basic_clean(x))[39;00m
[0;32m----> 2[0m df_small[[38;5;124m'[39m[38;5;124mtext[39m[38;5;124m'[39m] [38;5;241m=[39m df_small[[38;5;124m'[39m[38;5;124mBody[39m[38;5;124m'[39m][38;5;241m.[39mswifter[38;5;241m.[39mapply([38;5;28;01mlambda[39;00m x: basic_clean(x))

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/frame.py:3655[0m, in [0;36mDataFrame.__setitem__[0;34m(self, key, value)[0m
[1;32m   3652[0m     [38;5;28mself[39m[38;5;241m.[39m_setitem_array([key], value)
[1;32m   3653[0m [38;5;28;01melse[39;00m:
[1;32m   3654[0m     [38;5;66;03m# set column[39;00m
[0;32m-> 3655[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_set_item[49m[43m([49m[43mkey[49m[43m,[49m[43m [49m[43mvalue[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/frame.py:3845[0m, in [0;36mDataFrame._set_item[0;34m(self, key, value)[0m
[1;32m   3842[0m         [38;5;28;01mif[39;00m [38;5;28misinstance[39m(existing_piece, DataFrame):
[1;32m   3843[0m             value [38;5;241m=[39m np[38;5;241m.[39mtile(value, ([38;5;28mlen[39m(existing_piece[38;5;241m.[39mcolumns), [38;5;241m1[39m))[38;5;241m.[39mT
[0;32m-> 3845[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_set_item_mgr[49m[43m([49m[43mkey[49m[43m,[49m[43m [49m[43mvalue[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/frame.py:3810[0m, in [0;36mDataFrame._set_item_mgr[0;34m(self, key, value)[0m
[1;32m   3806[0m [38;5;66;03m# check if we are modifying a copy[39;00m
[1;32m   3807[0m [38;5;66;03m# try to set first as we want an invalid[39;00m
[1;32m   3808[0m [38;5;66;03m# value exception to occur first[39;00m
[1;32m   3809[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m([38;5;28mself[39m):
[0;32m-> 3810[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_check_setitem_copy[49m[43m([49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/generic.py:4016[0m, in [0;36mNDFrame._check_setitem_copy[0;34m(self, t, force)[0m
[1;32m   4005[0m     t [38;5;241m=[39m (
[1;32m   4006[0m         [38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m
[1;32m   4007[0m         [38;5;124m"[39m[38;5;124mA value is trying to be set on a copy of a slice from a [39m[38;5;124m"[39m
[0;32m   (...)[0m
[1;32m   4012[0m         [38;5;124m"[39m[38;5;124mindexing.html#returning-a-view-versus-a-copy[39m[38;5;124m"[39m
[1;32m   4013[0m     )
[1;32m   4015[0m [38;5;28;01mif[39;00m value [38;5;241m==[39m [38;5;124m"[39m[38;5;124mraise[39m[38;5;124m"[39m:
[0;32m-> 4016[0m     [38;5;28;01mraise[39;00m com[38;5;241m.[39mSettingWithCopyError(t)
[1;32m   4017[0m [38;5;28;01melif[39;00m value [38;5;241m==[39m [38;5;124m"[39m[38;5;124mwarn[39m[38;5;124m"[39m:
[1;32m   4018[0m     warnings[38;5;241m.[39mwarn(t, com[38;5;241m.[39mSettingWithCopyWarning, stacklevel[38;5;241m=[39mfind_stack_level())

[0;31mSettingWithCopyError[0m: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
[IPKernelApp] Aborting queue
[IPKernelApp] Finishing abort
[IPKernelApp] Exception in execute request:
[0;31m---------------------------------------------------------------------------[0m
[0;31mSettingWithCopyError[0m                      Traceback (most recent call last)
Input [0;32mIn [57][0m, in [0;36m<cell line: 2>[0;34m()[0m
[1;32m      1[0m [38;5;66;03m#df_raw['text'] = df_raw['Body'].swifter.apply(lambda x: basic_clean(x))[39;00m
[0;32m----> 2[0m df_small[[38;5;124m'[39m[38;5;124mtext[39m[38;5;124m'[39m] [38;5;241m=[39m df_small[[38;5;124m'[39m[38;5;124mBody[39m[38;5;124m'[39m][38;5;241m.[39mswifter[38;5;241m.[39mapply([38;5;28;01mlambda[39;00m x: basic_clean(x))

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/frame.py:3655[0m, in [0;36mDataFrame.__setitem__[0;34m(self, key, value)[0m
[1;32m   3652[0m     [38;5;28mself[39m[38;5;241m.[39m_setitem_array([key], value)
[1;32m   3653[0m [38;5;28;01melse[39;00m:
[1;32m   3654[0m     [38;5;66;03m# set column[39;00m
[0;32m-> 3655[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_set_item[49m[43m([49m[43mkey[49m[43m,[49m[43m [49m[43mvalue[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/frame.py:3845[0m, in [0;36mDataFrame._set_item[0;34m(self, key, value)[0m
[1;32m   3842[0m         [38;5;28;01mif[39;00m [38;5;28misinstance[39m(existing_piece, DataFrame):
[1;32m   3843[0m             value [38;5;241m=[39m np[38;5;241m.[39mtile(value, ([38;5;28mlen[39m(existing_piece[38;5;241m.[39mcolumns), [38;5;241m1[39m))[38;5;241m.[39mT
[0;32m-> 3845[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_set_item_mgr[49m[43m([49m[43mkey[49m[43m,[49m[43m [49m[43mvalue[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/frame.py:3810[0m, in [0;36mDataFrame._set_item_mgr[0;34m(self, key, value)[0m
[1;32m   3806[0m [38;5;66;03m# check if we are modifying a copy[39;00m
[1;32m   3807[0m [38;5;66;03m# try to set first as we want an invalid[39;00m
[1;32m   3808[0m [38;5;66;03m# value exception to occur first[39;00m
[1;32m   3809[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m([38;5;28mself[39m):
[0;32m-> 3810[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_check_setitem_copy[49m[43m([49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/generic.py:4016[0m, in [0;36mNDFrame._check_setitem_copy[0;34m(self, t, force)[0m
[1;32m   4005[0m     t [38;5;241m=[39m (
[1;32m   4006[0m         [38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m
[1;32m   4007[0m         [38;5;124m"[39m[38;5;124mA value is trying to be set on a copy of a slice from a [39m[38;5;124m"[39m
[0;32m   (...)[0m
[1;32m   4012[0m         [38;5;124m"[39m[38;5;124mindexing.html#returning-a-view-versus-a-copy[39m[38;5;124m"[39m
[1;32m   4013[0m     )
[1;32m   4015[0m [38;5;28;01mif[39;00m value [38;5;241m==[39m [38;5;124m"[39m[38;5;124mraise[39m[38;5;124m"[39m:
[0;32m-> 4016[0m     [38;5;28;01mraise[39;00m com[38;5;241m.[39mSettingWithCopyError(t)
[1;32m   4017[0m [38;5;28;01melif[39;00m value [38;5;241m==[39m [38;5;124m"[39m[38;5;124mwarn[39m[38;5;124m"[39m:
[1;32m   4018[0m     warnings[38;5;241m.[39mwarn(t, com[38;5;241m.[39mSettingWithCopyWarning, stacklevel[38;5;241m=[39mfind_stack_level())

[0;31mSettingWithCopyError[0m: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
[IPKernelApp] Aborting queue
[IPKernelApp] Finishing abort
[IPKernelApp] Exception in execute request:
[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Input [0;32mIn [73][0m, in [0;36m<cell line: 1>[0;34m()[0m
[0;32m----> 1[0m dls_lm_stack [38;5;241m=[39m [43mTextDataLoaders[49m[38;5;241;43m.[39;49m[43mfrom_df[49m[43m([49m[43mdf_raw[49m[43m,[49m[43m [49m[43mpath[49m[38;5;241;43m=[39;49m[43mpath[49m[43m,[49m[43m [49m[43mtext_col[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mtext[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mis_lm[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m      2[0m [43m                              [49m[43mvalid_pct[49m[38;5;241;43m=[39;49m[38;5;241;43m0.1[39;49m[43m,[49m[43m [49m[43mseed[49m[43m [49m[38;5;241;43m=[39;49m[38;5;241;43m123[39;49m[43m,[49m[43m [49m[43mbs[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m64[39;49m[43m,[49m[43m [49m[43mseq_len[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m72[39;49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/text/data.py:276[0m, in [0;36mTextDataLoaders.from_df[0;34m(cls, df, path, valid_pct, seed, text_col, label_col, label_delim, y_block, text_vocab, is_lm, valid_col, tok_tfm, tok_text_col, seq_len, backwards, **kwargs)[0m
[1;32m    271[0m splitter [38;5;241m=[39m RandomSplitter(valid_pct, seed[38;5;241m=[39mseed) [38;5;28;01mif[39;00m valid_col [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m ColSplitter(valid_col)
[1;32m    272[0m dblock [38;5;241m=[39m DataBlock(blocks[38;5;241m=[39mblocks,
[1;32m    273[0m                    get_x[38;5;241m=[39mColReader(tok_text_col),
[1;32m    274[0m                    get_y[38;5;241m=[39m[38;5;28;01mNone[39;00m [38;5;28;01mif[39;00m is_lm [38;5;28;01melse[39;00m ColReader(label_col, label_delim[38;5;241m=[39mlabel_delim),
[1;32m    275[0m                    splitter[38;5;241m=[39msplitter)
[0;32m--> 276[0m [38;5;28;01mreturn[39;00m [38;5;28;43mcls[39;49m[38;5;241;43m.[39;49m[43mfrom_dblock[49m[43m([49m[43mdblock[49m[43m,[49m[43m [49m[43mdf[49m[43m,[49m[43m [49m[43mpath[49m[38;5;241;43m=[39;49m[43mpath[49m[43m,[49m[43m [49m[43mseq_len[49m[38;5;241;43m=[39;49m[43mseq_len[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:195[0m, in [0;36mDataLoaders.from_dblock[0;34m(cls, dblock, source, path, bs, val_bs, shuffle, device, **kwargs)[0m
[1;32m    193[0m [38;5;129m@classmethod[39m
[1;32m    194[0m [38;5;28;01mdef[39;00m [38;5;21mfrom_dblock[39m([38;5;28mcls[39m, dblock, source, path[38;5;241m=[39m[38;5;124m'[39m[38;5;124m.[39m[38;5;124m'[39m,  bs[38;5;241m=[39m[38;5;241m64[39m, val_bs[38;5;241m=[39m[38;5;28;01mNone[39;00m, shuffle[38;5;241m=[39m[38;5;28;01mTrue[39;00m, device[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[0;32m--> 195[0m     [38;5;28;01mreturn[39;00m [43mdblock[49m[38;5;241;43m.[39;49m[43mdataloaders[49m[43m([49m[43msource[49m[43m,[49m[43m [49m[43mpath[49m[38;5;241;43m=[39;49m[43mpath[49m[43m,[49m[43m [49m[43mbs[49m[38;5;241;43m=[39;49m[43mbs[49m[43m,[49m[43m [49m[43mval_bs[49m[38;5;241;43m=[39;49m[43mval_bs[49m[43m,[49m[43m [49m[43mshuffle[49m[38;5;241;43m=[39;49m[43mshuffle[49m[43m,[49m[43m [49m[43mdevice[49m[38;5;241;43m=[39;49m[43mdevice[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/block.py:113[0m, in [0;36mDataBlock.dataloaders[0;34m(self, source, path, verbose, **kwargs)[0m
[1;32m    112[0m [38;5;28;01mdef[39;00m [38;5;21mdataloaders[39m([38;5;28mself[39m, source, path[38;5;241m=[39m[38;5;124m'[39m[38;5;124m.[39m[38;5;124m'[39m, verbose[38;5;241m=[39m[38;5;28;01mFalse[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[0;32m--> 113[0m     dsets [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdatasets[49m[43m([49m[43msource[49m[43m,[49m[43m [49m[43mverbose[49m[38;5;241;43m=[39;49m[43mverbose[49m[43m)[49m
[1;32m    114[0m     kwargs [38;5;241m=[39m {[38;5;241m*[39m[38;5;241m*[39m[38;5;28mself[39m[38;5;241m.[39mdls_kwargs, [38;5;241m*[39m[38;5;241m*[39mkwargs, [38;5;124m'[39m[38;5;124mverbose[39m[38;5;124m'[39m: verbose}
[1;32m    115[0m     [38;5;28;01mreturn[39;00m dsets[38;5;241m.[39mdataloaders(path[38;5;241m=[39mpath, after_item[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mitem_tfms, after_batch[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mbatch_tfms, [38;5;241m*[39m[38;5;241m*[39mkwargs)

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/block.py:110[0m, in [0;36mDataBlock.datasets[0;34m(self, source, verbose)[0m
[1;32m    108[0m splits [38;5;241m=[39m ([38;5;28mself[39m[38;5;241m.[39msplitter [38;5;129;01mor[39;00m RandomSplitter())(items)
[1;32m    109[0m pv([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mlen[39m(splits)[38;5;132;01m}[39;00m[38;5;124m datasets of sizes [39m[38;5;132;01m{[39;00m[38;5;124m'[39m[38;5;124m,[39m[38;5;124m'[39m[38;5;241m.[39mjoin([[38;5;28mstr[39m([38;5;28mlen[39m(s)) [38;5;28;01mfor[39;00m s [38;5;129;01min[39;00m splits])[38;5;132;01m}[39;00m[38;5;124m"[39m, verbose)
[0;32m--> 110[0m [38;5;28;01mreturn[39;00m [43mDatasets[49m[43m([49m[43mitems[49m[43m,[49m[43m [49m[43mtfms[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_combine_type_tfms[49m[43m([49m[43m)[49m[43m,[49m[43m [49m[43msplits[49m[38;5;241;43m=[39;49m[43msplits[49m[43m,[49m[43m [49m[43mdl_type[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdl_type[49m[43m,[49m[43m [49m[43mn_inp[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mn_inp[49m[43m,[49m[43m [49m[43mverbose[49m[38;5;241;43m=[39;49m[43mverbose[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:334[0m, in [0;36mDatasets.__init__[0;34m(self, items, tfms, tls, n_inp, dl_type, **kwargs)[0m
[1;32m    332[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, items[38;5;241m=[39m[38;5;28;01mNone[39;00m, tfms[38;5;241m=[39m[38;5;28;01mNone[39;00m, tls[38;5;241m=[39m[38;5;28;01mNone[39;00m, n_inp[38;5;241m=[39m[38;5;28;01mNone[39;00m, dl_type[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    333[0m     [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__init__[39m(dl_type[38;5;241m=[39mdl_type)
[0;32m--> 334[0m     [38;5;28mself[39m[38;5;241m.[39mtls [38;5;241m=[39m L(tls [38;5;28;01mif[39;00m tls [38;5;28;01melse[39;00m [TfmdLists(items, t, [38;5;241m*[39m[38;5;241m*[39mkwargs) [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m L(ifnone(tfms,[[38;5;28;01mNone[39;00m]))])
[1;32m    335[0m     [38;5;28mself[39m[38;5;241m.[39mn_inp [38;5;241m=[39m ifnone(n_inp, [38;5;28mmax[39m([38;5;241m1[39m, [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39mtls)[38;5;241m-[39m[38;5;241m1[39m))

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:334[0m, in [0;36m<listcomp>[0;34m(.0)[0m
[1;32m    332[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, items[38;5;241m=[39m[38;5;28;01mNone[39;00m, tfms[38;5;241m=[39m[38;5;28;01mNone[39;00m, tls[38;5;241m=[39m[38;5;28;01mNone[39;00m, n_inp[38;5;241m=[39m[38;5;28;01mNone[39;00m, dl_type[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    333[0m     [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__init__[39m(dl_type[38;5;241m=[39mdl_type)
[0;32m--> 334[0m     [38;5;28mself[39m[38;5;241m.[39mtls [38;5;241m=[39m L(tls [38;5;28;01mif[39;00m tls [38;5;28;01melse[39;00m [[43mTfmdLists[49m[43m([49m[43mitems[49m[43m,[49m[43m [49m[43mt[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m L(ifnone(tfms,[[38;5;28;01mNone[39;00m]))])
[1;32m    335[0m     [38;5;28mself[39m[38;5;241m.[39mn_inp [38;5;241m=[39m ifnone(n_inp, [38;5;28mmax[39m([38;5;241m1[39m, [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39mtls)[38;5;241m-[39m[38;5;241m1[39m))

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/foundation.py:97[0m, in [0;36m_L_Meta.__call__[0;34m(cls, x, *args, **kwargs)[0m
[1;32m     95[0m [38;5;28;01mdef[39;00m [38;5;21m__call__[39m([38;5;28mcls[39m, x[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m     96[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m args [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m kwargs [38;5;129;01mand[39;00m x [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m [38;5;28misinstance[39m(x,[38;5;28mcls[39m): [38;5;28;01mreturn[39;00m x
[0;32m---> 97[0m     [38;5;28;01mreturn[39;00m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__call__[39;49m[43m([49m[43mx[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:257[0m, in [0;36mTfmdLists.__init__[0;34m(self, items, tfms, use_list, do_setup, split_idx, train_setup, splits, types, verbose, dl_type)[0m
[1;32m    255[0m [38;5;28;01mif[39;00m do_setup:
[1;32m    256[0m     pv([38;5;124mf[39m[38;5;124m"[39m[38;5;124mSetting up [39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mtfms[38;5;132;01m}[39;00m[38;5;124m"[39m, verbose)
[0;32m--> 257[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msetup[49m[43m([49m[43mtrain_setup[49m[38;5;241;43m=[39;49m[43mtrain_setup[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:276[0m, in [0;36mTfmdLists.setup[0;34m(self, train_setup)[0m
[1;32m    275[0m [38;5;28;01mdef[39;00m [38;5;21msetup[39m([38;5;28mself[39m, train_setup[38;5;241m=[39m[38;5;28;01mTrue[39;00m):
[0;32m--> 276[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mtfms[49m[38;5;241;43m.[39;49m[43msetup[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mtrain_setup[49m[43m)[49m
[1;32m    277[0m     [38;5;28;01mif[39;00m [38;5;28mlen[39m([38;5;28mself[39m) [38;5;241m!=[39m [38;5;241m0[39m:
[1;32m    278[0m         x [38;5;241m=[39m [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__getitem__[39m([38;5;241m0[39m) [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39msplits [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__getitem__[39m([38;5;28mself[39m[38;5;241m.[39msplits[[38;5;241m0[39m])[[38;5;241m0[39m]

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/transform.py:192[0m, in [0;36mPipeline.setup[0;34m(self, items, train_setup)[0m
[1;32m    190[0m tfms [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mfs[:]
[1;32m    191[0m [38;5;28mself[39m[38;5;241m.[39mfs[38;5;241m.[39mclear()
[0;32m--> 192[0m [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m tfms: [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43madd[49m[43m([49m[43mt[49m[43m,[49m[43mitems[49m[43m,[49m[43m [49m[43mtrain_setup[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/transform.py:196[0m, in [0;36mPipeline.add[0;34m(self, ts, items, train_setup)[0m
[1;32m    194[0m [38;5;28;01mdef[39;00m [38;5;21madd[39m([38;5;28mself[39m,ts, items[38;5;241m=[39m[38;5;28;01mNone[39;00m, train_setup[38;5;241m=[39m[38;5;28;01mFalse[39;00m):
[1;32m    195[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m is_listy(ts): ts[38;5;241m=[39m[ts]
[0;32m--> 196[0m     [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m ts: [43mt[49m[38;5;241;43m.[39;49m[43msetup[49m[43m([49m[43mitems[49m[43m,[49m[43m [49m[43mtrain_setup[49m[43m)[49m
[1;32m    197[0m     [38;5;28mself[39m[38;5;241m.[39mfs[38;5;241m+[39m[38;5;241m=[39mts
[1;32m    198[0m     [38;5;28mself[39m[38;5;241m.[39mfs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mfs[38;5;241m.[39msorted(key[38;5;241m=[39m[38;5;124m'[39m[38;5;124morder[39m[38;5;124m'[39m)

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/transform.py:79[0m, in [0;36mTransform.setup[0;34m(self, items, train_setup)[0m
[1;32m     77[0m [38;5;28;01mdef[39;00m [38;5;21msetup[39m([38;5;28mself[39m, items[38;5;241m=[39m[38;5;28;01mNone[39;00m, train_setup[38;5;241m=[39m[38;5;28;01mFalse[39;00m):
[1;32m     78[0m     train_setup [38;5;241m=[39m train_setup [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtrain_setup [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m [38;5;28mself[39m[38;5;241m.[39mtrain_setup
[0;32m---> 79[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msetups[49m[43m([49m[38;5;28;43mgetattr[39;49m[43m([49m[43mitems[49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mtrain[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mitems[49m[43m)[49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mtrain_setup[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mitems[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/dispatch.py:123[0m, in [0;36mTypeDispatch.__call__[0;34m(self, *args, **kwargs)[0m
[1;32m    121[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39minst [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m: f [38;5;241m=[39m MethodType(f, [38;5;28mself[39m[38;5;241m.[39minst)
[1;32m    122[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39mowner [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m: f [38;5;241m=[39m MethodType(f, [38;5;28mself[39m[38;5;241m.[39mowner)
[0;32m--> 123[0m [38;5;28;01mreturn[39;00m [43mf[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/text/core.py:285[0m, in [0;36mTokenizer.setups[0;34m(self, dsets)[0m
[1;32m    283[0m [38;5;28;01mdef[39;00m [38;5;21msetups[39m([38;5;28mself[39m, dsets):
[1;32m    284[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39mmode [38;5;241m==[39m [38;5;124m'[39m[38;5;124mdf[39m[38;5;124m'[39m [38;5;129;01mor[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(dsets[38;5;241m.[39mitems, pd[38;5;241m.[39mDataFrame): [38;5;28;01mreturn[39;00m
[0;32m--> 285[0m     dsets[38;5;241m.[39mitems,count [38;5;241m=[39m [43mtokenize_df[49m[43m([49m[43mdsets[49m[38;5;241;43m.[39;49m[43mitems[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mtext_cols[49m[43m,[49m[43m [49m[43mrules[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mrules[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mkwargs[49m[43m)[49m
[1;32m    286[0m     [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mcounter [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m: [38;5;28mself[39m[38;5;241m.[39mcounter [38;5;241m=[39m count
[1;32m    287[0m     [38;5;28;01mreturn[39;00m dsets

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/text/core.py:218[0m, in [0;36mtokenize_df[0;34m(df, text_cols, n_workers, rules, mark_fields, tok, tok_text_col)[0m
[1;32m    216[0m [38;5;28;01mif[39;00m mark_fields [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m: mark_fields [38;5;241m=[39m [38;5;28mlen[39m(text_cols)[38;5;241m>[39m[38;5;241m1[39m
[1;32m    217[0m rules [38;5;241m=[39m L(ifnone(rules, defaults[38;5;241m.[39mtext_proc_rules[38;5;241m.[39mcopy()))
[0;32m--> 218[0m texts [38;5;241m=[39m _join_texts([43mdf[49m[43m[[49m[43mtext_cols[49m[43m][49m, mark_fields[38;5;241m=[39mmark_fields)
[1;32m    219[0m outputs [38;5;241m=[39m L(parallel_tokenize(texts, tok, rules, n_workers[38;5;241m=[39mn_workers)
[1;32m    220[0m            )[38;5;241m.[39msorted()[38;5;241m.[39mitemgot([38;5;241m1[39m)
[1;32m    222[0m other_cols [38;5;241m=[39m df[38;5;241m.[39mcolumns[[38;5;241m~[39mdf[38;5;241m.[39mcolumns[38;5;241m.[39misin(text_cols)]

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/frame.py:3511[0m, in [0;36mDataFrame.__getitem__[0;34m(self, key)[0m
[1;32m   3509[0m     [38;5;28;01mif[39;00m is_iterator(key):
[1;32m   3510[0m         key [38;5;241m=[39m [38;5;28mlist[39m(key)
[0;32m-> 3511[0m     indexer [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcolumns[49m[38;5;241;43m.[39;49m[43m_get_indexer_strict[49m[43m([49m[43mkey[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mcolumns[39;49m[38;5;124;43m"[39;49m[43m)[49m[[38;5;241m1[39m]
[1;32m   3513[0m [38;5;66;03m# take() does not accept boolean indexers[39;00m
[1;32m   3514[0m [38;5;28;01mif[39;00m [38;5;28mgetattr[39m(indexer, [38;5;124m"[39m[38;5;124mdtype[39m[38;5;124m"[39m, [38;5;28;01mNone[39;00m) [38;5;241m==[39m [38;5;28mbool[39m:

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/indexes/base.py:5782[0m, in [0;36mIndex._get_indexer_strict[0;34m(self, key, axis_name)[0m
[1;32m   5779[0m [38;5;28;01melse[39;00m:
[1;32m   5780[0m     keyarr, indexer, new_indexer [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_reindex_non_unique(keyarr)
[0;32m-> 5782[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_raise_if_missing[49m[43m([49m[43mkeyarr[49m[43m,[49m[43m [49m[43mindexer[49m[43m,[49m[43m [49m[43maxis_name[49m[43m)[49m
[1;32m   5784[0m keyarr [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mtake(indexer)
[1;32m   5785[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(key, Index):
[1;32m   5786[0m     [38;5;66;03m# GH 42790 - Preserve name from an Index[39;00m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/indexes/base.py:5842[0m, in [0;36mIndex._raise_if_missing[0;34m(self, key, indexer, axis_name)[0m
[1;32m   5840[0m     [38;5;28;01mif[39;00m use_interval_msg:
[1;32m   5841[0m         key [38;5;241m=[39m [38;5;28mlist[39m(key)
[0;32m-> 5842[0m     [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mNone of [[39m[38;5;132;01m{[39;00mkey[38;5;132;01m}[39;00m[38;5;124m] are in the [[39m[38;5;132;01m{[39;00maxis_name[38;5;132;01m}[39;00m[38;5;124m][39m[38;5;124m"[39m)
[1;32m   5844[0m not_found [38;5;241m=[39m [38;5;28mlist[39m(ensure_index(key)[missing_mask[38;5;241m.[39mnonzero()[[38;5;241m0[39m]][38;5;241m.[39munique())
[1;32m   5845[0m [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00mnot_found[38;5;132;01m}[39;00m[38;5;124m not in index[39m[38;5;124m"[39m)

[0;31mKeyError[0m: "None of [Index(['text'], dtype='object')] are in the [columns]"
[IPKernelApp] Aborting queue
[IPKernelApp] Aborting 1aa0059b-7557-4a2c-a9b8-2a8fdb43239a: execute_request
[IPKernelApp] Aborting ea7b396b-58e4-4b64-a027-30f9fd3f8ae3: execute_request
[IPKernelApp] Aborting a2eaad56-155c-4144-b7b8-48a090365115: execute_request
[IPKernelApp] Aborting 4107db07-130e-43c9-90a1-201ec366b3a4: execute_request
[IPKernelApp] Aborting e94ccedb-e4c8-4200-a54e-c5d77c3719e0: execute_request
[IPKernelApp] Aborting ae444a6a-4797-4575-ae03-93ab81ac165d: execute_request
[IPKernelApp] Aborting 137f309c-6dcc-4ffd-9099-ab8790b589fa: execute_request
[IPKernelApp] Aborting 9960c234-69ef-49e6-9887-6c32db09a7d5: execute_request
[IPKernelApp] Aborting fbe7227c-2b77-45a8-9dd4-c43672d8c8eb: execute_request
[IPKernelApp] Aborting bd673767-9c5c-48d6-84d1-3dee102b35bd: execute_request
[IPKernelApp] Aborting 7a7660c8-e26f-4cd5-aaa1-6a584d0017a0: execute_request
[IPKernelApp] Aborting 9faa0f78-41cc-4222-b5bc-ece5dfa1b011: execute_request
[IPKernelApp] Aborting 2e7af859-db83-4361-8791-ff78c94b8abc: execute_request
[IPKernelApp] Aborting 988eff7e-7698-46c7-a1f9-017b237f104e: execute_request
[IPKernelApp] Aborting 33abc7be-aee5-4c3b-8e88-c0254553ca21: execute_request
[IPKernelApp] Aborting 1e391983-0efa-4e22-a2da-ecfe806877e7: execute_request
[IPKernelApp] Aborting c49def98-06e1-4b94-9442-0985e043e3ae: execute_request
[IPKernelApp] Aborting 6a03a726-b5c4-46cf-ae76-590f8ac0c714: execute_request
[IPKernelApp] Finishing abort
[IPKernelApp] Exception in execute request:
[0;31m---------------------------------------------------------------------------[0m
[0;31mAttributeError[0m                            Traceback (most recent call last)
File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/swifter/swifter.py:239[0m, in [0;36mSeriesAccessor.apply[0;34m(self, func, convert_dtype, args, **kwds)[0m
[1;32m    238[0m [38;5;28;01mwith[39;00m suppress_stdout_stderr_logging():
[0;32m--> 239[0m     tmp_df [38;5;241m=[39m [43mfunc[49m[43m([49m[43msample[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwds[49m[43m)[49m
[1;32m    240[0m     sample_df [38;5;241m=[39m sample[38;5;241m.[39mapply(func, convert_dtype[38;5;241m=[39mconvert_dtype, args[38;5;241m=[39margs, [38;5;241m*[39m[38;5;241m*[39mkwds)

Input [0;32mIn [75][0m, in [0;36m<lambda>[0;34m(x)[0m
[1;32m      1[0m [38;5;66;03m#df_raw['text'] = df_raw['Body'].swifter.apply(lambda x: basic_clean(x))[39;00m
[0;32m----> 2[0m df_small[[38;5;124m'[39m[38;5;124mtext[39m[38;5;124m'[39m] [38;5;241m=[39m df_small[[38;5;124m'[39m[38;5;124mBody[39m[38;5;124m'[39m][38;5;241m.[39mswifter[38;5;241m.[39mapply([38;5;28;01mlambda[39;00m x: [43mbasic_clean[49m[43m([49m[43mx[49m[43m)[49m)

Input [0;32mIn [46][0m, in [0;36mbasic_clean[0;34m(text)[0m
[1;32m      6[0m [38;5;66;03m#if (bool(BeautifulSoup(text, "html.parser").find())==True):         [39;00m
[1;32m      7[0m [38;5;66;03m#    soup = BeautifulSoup(text, "html.parser")[39;00m
[0;32m----> 8[0m [38;5;28;01mif[39;00m ([38;5;28mbool[39m([43mBeautifulSoup[49m[43m([49m[43mtext[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mhtml5lib[39;49m[38;5;124;43m"[39;49m[43m)[49m[38;5;241m.[39mfind())[38;5;241m==[39m[38;5;28;01mTrue[39;00m):         
[1;32m      9[0m     soup [38;5;241m=[39m BeautifulSoup(text, [38;5;124m"[39m[38;5;124mhtml5lib[39m[38;5;124m"[39m)

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/bs4/__init__.py:326[0m, in [0;36mBeautifulSoup.__init__[0;34m(self, markup, features, builder, parse_only, from_encoding, exclude_encodings, element_classes, **kwargs)[0m
[1;32m    325[0m success [38;5;241m=[39m [38;5;28;01mFalse[39;00m
[0;32m--> 326[0m [38;5;28;01mfor[39;00m ([38;5;28mself[39m[38;5;241m.[39mmarkup, [38;5;28mself[39m[38;5;241m.[39moriginal_encoding, [38;5;28mself[39m[38;5;241m.[39mdeclared_html_encoding,
[1;32m    327[0m  [38;5;28mself[39m[38;5;241m.[39mcontains_replacement_characters) [38;5;129;01min[39;00m (
[1;32m    328[0m      [38;5;28mself[39m[38;5;241m.[39mbuilder[38;5;241m.[39mprepare_markup(
[1;32m    329[0m          markup, from_encoding, exclude_encodings[38;5;241m=[39mexclude_encodings)):
[1;32m    330[0m     [38;5;28mself[39m[38;5;241m.[39mreset()

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/bs4/builder/_html5lib.py:77[0m, in [0;36mHTML5TreeBuilder.prepare_markup[0;34m(self, markup, user_specified_encoding, document_declared_encoding, exclude_encodings)[0m
[1;32m     75[0m [38;5;66;03m# html5lib only parses HTML, so if it's given XML that's worth[39;00m
[1;32m     76[0m [38;5;66;03m# noting.[39;00m
[0;32m---> 77[0m [43mDetectsXMLParsedAsHTML[49m[38;5;241;43m.[39;49m[43mwarn_if_markup_looks_like_xml[49m[43m([49m[43mmarkup[49m[43m)[49m
[1;32m     79[0m [38;5;28;01myield[39;00m (markup, [38;5;28;01mNone[39;00m, [38;5;28;01mNone[39;00m, [38;5;28;01mFalse[39;00m)

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/bs4/builder/__init__.py:535[0m, in [0;36mDetectsXMLParsedAsHTML.warn_if_markup_looks_like_xml[0;34m(cls, markup)[0m
[1;32m    532[0m     looks_like_html [38;5;241m=[39m [38;5;28mcls[39m[38;5;241m.[39mLOOKS_LIKE_HTML
[1;32m    534[0m [38;5;28;01mif[39;00m (markup [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[0;32m--> 535[0m     [38;5;129;01mand[39;00m [43mmarkup[49m[38;5;241;43m.[39;49m[43mstartswith[49m(prefix)
[1;32m    536[0m     [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m looks_like_html[38;5;241m.[39msearch(markup[:[38;5;241m500[39m])
[1;32m    537[0m ):
[1;32m    538[0m     [38;5;28mcls[39m[38;5;241m.[39m_warn()

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/generic.py:5575[0m, in [0;36mNDFrame.__getattr__[0;34m(self, name)[0m
[1;32m   5574[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[name]
[0;32m-> 5575[0m [38;5;28;01mreturn[39;00m [38;5;28;43mobject[39;49m[38;5;241;43m.[39;49m[38;5;21;43m__getattribute__[39;49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mname[49m[43m)[49m

[0;31mAttributeError[0m: 'Series' object has no attribute 'startswith'

During handling of the above exception, another exception occurred:

[0;31mKeyboardInterrupt[0m                         Traceback (most recent call last)
Input [0;32mIn [75][0m, in [0;36m<cell line: 2>[0;34m()[0m
[1;32m      1[0m [38;5;66;03m#df_raw['text'] = df_raw['Body'].swifter.apply(lambda x: basic_clean(x))[39;00m
[0;32m----> 2[0m df_small[[38;5;124m'[39m[38;5;124mtext[39m[38;5;124m'[39m] [38;5;241m=[39m [43mdf_small[49m[43m[[49m[38;5;124;43m'[39;49m[38;5;124;43mBody[39;49m[38;5;124;43m'[39;49m[43m][49m[38;5;241;43m.[39;49m[43mswifter[49m[38;5;241;43m.[39;49m[43mapply[49m[43m([49m[38;5;28;43;01mlambda[39;49;00m[43m [49m[43mx[49m[43m:[49m[43m [49m[43mbasic_clean[49m[43m([49m[43mx[49m[43m)[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/swifter/swifter.py:259[0m, in [0;36mSeriesAccessor.apply[0;34m(self, func, convert_dtype, args, **kwds)[0m
[1;32m    257[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39m_progress_bar:
[1;32m    258[0m     tqdm[38;5;241m.[39mpandas(desc[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39m_progress_bar_desc [38;5;129;01mor[39;00m [38;5;124m"[39m[38;5;124mPandas Apply[39m[38;5;124m"[39m)
[0;32m--> 259[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_obj[49m[38;5;241;43m.[39;49m[43mprogress_apply[49m[43m([49m[43mfunc[49m[43m,[49m[43m [49m[43mconvert_dtype[49m[38;5;241;43m=[39;49m[43mconvert_dtype[49m[43m,[49m[43m [49m[43margs[49m[38;5;241;43m=[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwds[49m[43m)[49m
[1;32m    260[0m [38;5;28;01melse[39;00m:
[1;32m    261[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_obj[38;5;241m.[39mapply(func, convert_dtype[38;5;241m=[39mconvert_dtype, args[38;5;241m=[39margs, [38;5;241m*[39m[38;5;241m*[39mkwds)

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/tqdm/std.py:814[0m, in [0;36mtqdm.pandas.<locals>.inner_generator.<locals>.inner[0;34m(df, func, *args, **kwargs)[0m
[1;32m    811[0m [38;5;66;03m# Apply the provided function (in **kwargs)[39;00m
[1;32m    812[0m [38;5;66;03m# on the df using our wrapper (which provides bar updating)[39;00m
[1;32m    813[0m [38;5;28;01mtry[39;00m:
[0;32m--> 814[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mgetattr[39;49m[43m([49m[43mdf[49m[43m,[49m[43m [49m[43mdf_function[49m[43m)[49m[43m([49m[43mwrapper[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    815[0m [38;5;28;01mfinally[39;00m:
[1;32m    816[0m     t[38;5;241m.[39mclose()

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/series.py:4433[0m, in [0;36mSeries.apply[0;34m(self, func, convert_dtype, args, **kwargs)[0m
[1;32m   4323[0m [38;5;28;01mdef[39;00m [38;5;21mapply[39m(
[1;32m   4324[0m     [38;5;28mself[39m,
[1;32m   4325[0m     func: AggFuncType,
[0;32m   (...)[0m
[1;32m   4328[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs,
[1;32m   4329[0m ) [38;5;241m-[39m[38;5;241m>[39m DataFrame [38;5;241m|[39m Series:
[1;32m   4330[0m     [38;5;124;03m"""[39;00m
[1;32m   4331[0m [38;5;124;03m    Invoke function on values of Series.[39;00m
[1;32m   4332[0m 
[0;32m   (...)[0m
[1;32m   4431[0m [38;5;124;03m    dtype: float64[39;00m
[1;32m   4432[0m [38;5;124;03m    """[39;00m
[0;32m-> 4433[0m     [38;5;28;01mreturn[39;00m [43mSeriesApply[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mfunc[49m[43m,[49m[43m [49m[43mconvert_dtype[49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[43mkwargs[49m[43m)[49m[38;5;241;43m.[39;49m[43mapply[49m[43m([49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/apply.py:1082[0m, in [0;36mSeriesApply.apply[0;34m(self)[0m
[1;32m   1078[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m([38;5;28mself[39m[38;5;241m.[39mf, [38;5;28mstr[39m):
[1;32m   1079[0m     [38;5;66;03m# if we are a string, try to dispatch[39;00m
[1;32m   1080[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mapply_str()
[0;32m-> 1082[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mapply_standard[49m[43m([49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/apply.py:1137[0m, in [0;36mSeriesApply.apply_standard[0;34m(self)[0m
[1;32m   1131[0m         values [38;5;241m=[39m obj[38;5;241m.[39mastype([38;5;28mobject[39m)[38;5;241m.[39m_values
[1;32m   1132[0m         [38;5;66;03m# error: Argument 2 to "map_infer" has incompatible type[39;00m
[1;32m   1133[0m         [38;5;66;03m# "Union[Callable[..., Any], str, List[Union[Callable[..., Any], str]],[39;00m
[1;32m   1134[0m         [38;5;66;03m# Dict[Hashable, Union[Union[Callable[..., Any], str],[39;00m
[1;32m   1135[0m         [38;5;66;03m# List[Union[Callable[..., Any], str]]]]]"; expected[39;00m
[1;32m   1136[0m         [38;5;66;03m# "Callable[[Any], Any]"[39;00m
[0;32m-> 1137[0m         mapped [38;5;241m=[39m [43mlib[49m[38;5;241;43m.[39;49m[43mmap_infer[49m[43m([49m
[1;32m   1138[0m [43m            [49m[43mvalues[49m[43m,[49m
[1;32m   1139[0m [43m            [49m[43mf[49m[43m,[49m[43m  [49m[38;5;66;43;03m# type: ignore[arg-type][39;49;00m
[1;32m   1140[0m [43m            [49m[43mconvert[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mconvert_dtype[49m[43m,[49m
[1;32m   1141[0m [43m        [49m[43m)[49m
[1;32m   1143[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(mapped) [38;5;129;01mand[39;00m [38;5;28misinstance[39m(mapped[[38;5;241m0[39m], ABCSeries):
[1;32m   1144[0m     [38;5;66;03m# GH#43986 Need to do list(mapped) in order to get treated as nested[39;00m
[1;32m   1145[0m     [38;5;66;03m#  See also GH#25959 regarding EA support[39;00m
[1;32m   1146[0m     [38;5;28;01mreturn[39;00m obj[38;5;241m.[39m_constructor_expanddim([38;5;28mlist[39m(mapped), index[38;5;241m=[39mobj[38;5;241m.[39mindex)

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/_libs/lib.pyx:2870[0m, in [0;36mpandas._libs.lib.map_infer[0;34m()[0m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/tqdm/std.py:809[0m, in [0;36mtqdm.pandas.<locals>.inner_generator.<locals>.inner.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    803[0m [38;5;28;01mdef[39;00m [38;5;21mwrapper[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    804[0m     [38;5;66;03m# update tbar correctly[39;00m
[1;32m    805[0m     [38;5;66;03m# it seems `pandas apply` calls `func` twice[39;00m
[1;32m    806[0m     [38;5;66;03m# on the first column/row to decide whether it can[39;00m
[1;32m    807[0m     [38;5;66;03m# take a fast or slow code path; so stop when t.total==t.n[39;00m
[1;32m    808[0m     t[38;5;241m.[39mupdate(n[38;5;241m=[39m[38;5;241m1[39m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m t[38;5;241m.[39mtotal [38;5;129;01mor[39;00m t[38;5;241m.[39mn [38;5;241m<[39m t[38;5;241m.[39mtotal [38;5;28;01melse[39;00m [38;5;241m0[39m)
[0;32m--> 809[0m     [38;5;28;01mreturn[39;00m [43mfunc[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

Input [0;32mIn [75][0m, in [0;36m<lambda>[0;34m(x)[0m
[1;32m      1[0m [38;5;66;03m#df_raw['text'] = df_raw['Body'].swifter.apply(lambda x: basic_clean(x))[39;00m
[0;32m----> 2[0m df_small[[38;5;124m'[39m[38;5;124mtext[39m[38;5;124m'[39m] [38;5;241m=[39m df_small[[38;5;124m'[39m[38;5;124mBody[39m[38;5;124m'[39m][38;5;241m.[39mswifter[38;5;241m.[39mapply([38;5;28;01mlambda[39;00m x: [43mbasic_clean[49m[43m([49m[43mx[49m[43m)[49m)

Input [0;32mIn [46][0m, in [0;36mbasic_clean[0;34m(text)[0m
[1;32m      6[0m [38;5;66;03m#if (bool(BeautifulSoup(text, "html.parser").find())==True):         [39;00m
[1;32m      7[0m [38;5;66;03m#    soup = BeautifulSoup(text, "html.parser")[39;00m
[1;32m      8[0m [38;5;28;01mif[39;00m ([38;5;28mbool[39m(BeautifulSoup(text, [38;5;124m"[39m[38;5;124mhtml5lib[39m[38;5;124m"[39m)[38;5;241m.[39mfind())[38;5;241m==[39m[38;5;28;01mTrue[39;00m):         
[0;32m----> 9[0m     soup [38;5;241m=[39m [43mBeautifulSoup[49m[43m([49m[43mtext[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mhtml5lib[39;49m[38;5;124;43m"[39;49m[43m)[49m
[1;32m     10[0m     text [38;5;241m=[39m soup[38;5;241m.[39mget_text()
[1;32m     11[0m [38;5;28;01melse[39;00m:

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/bs4/__init__.py:330[0m, in [0;36mBeautifulSoup.__init__[0;34m(self, markup, features, builder, parse_only, from_encoding, exclude_encodings, element_classes, **kwargs)[0m
[1;32m    325[0m success [38;5;241m=[39m [38;5;28;01mFalse[39;00m
[1;32m    326[0m [38;5;28;01mfor[39;00m ([38;5;28mself[39m[38;5;241m.[39mmarkup, [38;5;28mself[39m[38;5;241m.[39moriginal_encoding, [38;5;28mself[39m[38;5;241m.[39mdeclared_html_encoding,
[1;32m    327[0m  [38;5;28mself[39m[38;5;241m.[39mcontains_replacement_characters) [38;5;129;01min[39;00m (
[1;32m    328[0m      [38;5;28mself[39m[38;5;241m.[39mbuilder[38;5;241m.[39mprepare_markup(
[1;32m    329[0m          markup, from_encoding, exclude_encodings[38;5;241m=[39mexclude_encodings)):
[0;32m--> 330[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mreset[49m[43m([49m[43m)[49m
[1;32m    331[0m     [38;5;28mself[39m[38;5;241m.[39mbuilder[38;5;241m.[39minitialize_soup([38;5;28mself[39m)
[1;32m    332[0m     [38;5;28;01mtry[39;00m:

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/bs4/__init__.py:461[0m, in [0;36mBeautifulSoup.reset[0;34m(self)[0m
[1;32m    457[0m [38;5;28;01mdef[39;00m [38;5;21mreset[39m([38;5;28mself[39m):
[1;32m    458[0m     [38;5;124;03m"""Reset this object to a state as though it had never parsed any[39;00m
[1;32m    459[0m [38;5;124;03m    markup.[39;00m
[1;32m    460[0m [38;5;124;03m    """[39;00m
[0;32m--> 461[0m     Tag[38;5;241m.[39m[38;5;21m__init__[39m([38;5;28mself[39m, [38;5;28mself[39m, [38;5;28mself[39m[38;5;241m.[39mbuilder, [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mROOT_TAG_NAME[49m)
[1;32m    462[0m     [38;5;28mself[39m[38;5;241m.[39mhidden [38;5;241m=[39m [38;5;241m1[39m
[1;32m    463[0m     [38;5;28mself[39m[38;5;241m.[39mbuilder[38;5;241m.[39mreset()

[0;31mKeyboardInterrupt[0m: 
[IPKernelApp] Aborting queue
[IPKernelApp] Aborting a3a775f7-6cb9-4e58-9769-969c3833844b: execute_request
[IPKernelApp] Aborting c2c910ad-ff66-4151-948a-7bf1a5045ee0: execute_request
[IPKernelApp] Aborting 6ea0568c-78b6-475c-96f5-ceae52b201af: execute_request
[IPKernelApp] Aborting a9493cad-1b7a-4549-aa3a-ec01618c00d2: execute_request
[IPKernelApp] Aborting 979a52be-306b-4509-abde-0c9244c5b854: execute_request
[IPKernelApp] Aborting 48fd6f51-b102-4d0d-92fd-9e4c02ebb623: execute_request
[IPKernelApp] Aborting 14565edf-f0ae-4e02-b14c-26c150c6aa56: execute_request
[IPKernelApp] Aborting 8d71695c-91e2-49e3-a459-da8e18da606f: execute_request
[IPKernelApp] Aborting 12a7f16e-6f7d-4dd8-815d-8c24227bb6af: execute_request
[IPKernelApp] Aborting 22d34733-e32b-455d-967f-c309f7a04b3b: execute_request
[IPKernelApp] Aborting 84b24667-f6c4-48cb-b56c-02af7c46bfb0: execute_request
[IPKernelApp] Aborting a6596fa4-a57c-4d29-9d95-046a9d97cbe9: execute_request
[IPKernelApp] Aborting 05e2dacd-695d-4afc-a96f-665ca5753072: execute_request
[IPKernelApp] Aborting bec7680c-a18f-4cee-a787-5dd740fc10c1: execute_request
[IPKernelApp] Aborting 57c4fdda-2950-4d07-a79b-fbd41198e676: execute_request
[IPKernelApp] Aborting 565b1ab4-bd55-4e5e-993b-5c191285dc18: execute_request
[IPKernelApp] Aborting 563e3fb0-37d5-459d-bde5-a54eae95091f: execute_request
[IPKernelApp] Aborting ef7c2690-7b69-425c-8412-1f6d41371ce2: execute_request
[IPKernelApp] Aborting 1cdb426b-7bdd-46a1-b670-b5342f070ba2: execute_request
[IPKernelApp] Finishing abort
[IPKernelApp] Exception in execute request:
[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Input [0;32mIn [81][0m, in [0;36m<cell line: 1>[0;34m()[0m
[0;32m----> 1[0m dls_lm_stack [38;5;241m=[39m [43mTextDataLoaders[49m[38;5;241;43m.[39;49m[43mfrom_df[49m[43m([49m[43mdf_raw[49m[43m,[49m[43m [49m[43mpath[49m[38;5;241;43m=[39;49m[43mpath[49m[43m,[49m[43m [49m[43mtext_col[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mtext[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mis_lm[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m      2[0m [43m                              [49m[43mvalid_pct[49m[38;5;241;43m=[39;49m[38;5;241;43m0.1[39;49m[43m,[49m[43m [49m[43mseed[49m[43m [49m[38;5;241;43m=[39;49m[38;5;241;43m123[39;49m[43m,[49m[43m [49m[43mbs[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m64[39;49m[43m,[49m[43m [49m[43mseq_len[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;241;43m72[39;49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/text/data.py:276[0m, in [0;36mTextDataLoaders.from_df[0;34m(cls, df, path, valid_pct, seed, text_col, label_col, label_delim, y_block, text_vocab, is_lm, valid_col, tok_tfm, tok_text_col, seq_len, backwards, **kwargs)[0m
[1;32m    271[0m splitter [38;5;241m=[39m RandomSplitter(valid_pct, seed[38;5;241m=[39mseed) [38;5;28;01mif[39;00m valid_col [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m ColSplitter(valid_col)
[1;32m    272[0m dblock [38;5;241m=[39m DataBlock(blocks[38;5;241m=[39mblocks,
[1;32m    273[0m                    get_x[38;5;241m=[39mColReader(tok_text_col),
[1;32m    274[0m                    get_y[38;5;241m=[39m[38;5;28;01mNone[39;00m [38;5;28;01mif[39;00m is_lm [38;5;28;01melse[39;00m ColReader(label_col, label_delim[38;5;241m=[39mlabel_delim),
[1;32m    275[0m                    splitter[38;5;241m=[39msplitter)
[0;32m--> 276[0m [38;5;28;01mreturn[39;00m [38;5;28;43mcls[39;49m[38;5;241;43m.[39;49m[43mfrom_dblock[49m[43m([49m[43mdblock[49m[43m,[49m[43m [49m[43mdf[49m[43m,[49m[43m [49m[43mpath[49m[38;5;241;43m=[39;49m[43mpath[49m[43m,[49m[43m [49m[43mseq_len[49m[38;5;241;43m=[39;49m[43mseq_len[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:195[0m, in [0;36mDataLoaders.from_dblock[0;34m(cls, dblock, source, path, bs, val_bs, shuffle, device, **kwargs)[0m
[1;32m    193[0m [38;5;129m@classmethod[39m
[1;32m    194[0m [38;5;28;01mdef[39;00m [38;5;21mfrom_dblock[39m([38;5;28mcls[39m, dblock, source, path[38;5;241m=[39m[38;5;124m'[39m[38;5;124m.[39m[38;5;124m'[39m,  bs[38;5;241m=[39m[38;5;241m64[39m, val_bs[38;5;241m=[39m[38;5;28;01mNone[39;00m, shuffle[38;5;241m=[39m[38;5;28;01mTrue[39;00m, device[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[0;32m--> 195[0m     [38;5;28;01mreturn[39;00m [43mdblock[49m[38;5;241;43m.[39;49m[43mdataloaders[49m[43m([49m[43msource[49m[43m,[49m[43m [49m[43mpath[49m[38;5;241;43m=[39;49m[43mpath[49m[43m,[49m[43m [49m[43mbs[49m[38;5;241;43m=[39;49m[43mbs[49m[43m,[49m[43m [49m[43mval_bs[49m[38;5;241;43m=[39;49m[43mval_bs[49m[43m,[49m[43m [49m[43mshuffle[49m[38;5;241;43m=[39;49m[43mshuffle[49m[43m,[49m[43m [49m[43mdevice[49m[38;5;241;43m=[39;49m[43mdevice[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/block.py:113[0m, in [0;36mDataBlock.dataloaders[0;34m(self, source, path, verbose, **kwargs)[0m
[1;32m    112[0m [38;5;28;01mdef[39;00m [38;5;21mdataloaders[39m([38;5;28mself[39m, source, path[38;5;241m=[39m[38;5;124m'[39m[38;5;124m.[39m[38;5;124m'[39m, verbose[38;5;241m=[39m[38;5;28;01mFalse[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[0;32m--> 113[0m     dsets [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdatasets[49m[43m([49m[43msource[49m[43m,[49m[43m [49m[43mverbose[49m[38;5;241;43m=[39;49m[43mverbose[49m[43m)[49m
[1;32m    114[0m     kwargs [38;5;241m=[39m {[38;5;241m*[39m[38;5;241m*[39m[38;5;28mself[39m[38;5;241m.[39mdls_kwargs, [38;5;241m*[39m[38;5;241m*[39mkwargs, [38;5;124m'[39m[38;5;124mverbose[39m[38;5;124m'[39m: verbose}
[1;32m    115[0m     [38;5;28;01mreturn[39;00m dsets[38;5;241m.[39mdataloaders(path[38;5;241m=[39mpath, after_item[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mitem_tfms, after_batch[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mbatch_tfms, [38;5;241m*[39m[38;5;241m*[39mkwargs)

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/block.py:110[0m, in [0;36mDataBlock.datasets[0;34m(self, source, verbose)[0m
[1;32m    108[0m splits [38;5;241m=[39m ([38;5;28mself[39m[38;5;241m.[39msplitter [38;5;129;01mor[39;00m RandomSplitter())(items)
[1;32m    109[0m pv([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mlen[39m(splits)[38;5;132;01m}[39;00m[38;5;124m datasets of sizes [39m[38;5;132;01m{[39;00m[38;5;124m'[39m[38;5;124m,[39m[38;5;124m'[39m[38;5;241m.[39mjoin([[38;5;28mstr[39m([38;5;28mlen[39m(s)) [38;5;28;01mfor[39;00m s [38;5;129;01min[39;00m splits])[38;5;132;01m}[39;00m[38;5;124m"[39m, verbose)
[0;32m--> 110[0m [38;5;28;01mreturn[39;00m [43mDatasets[49m[43m([49m[43mitems[49m[43m,[49m[43m [49m[43mtfms[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_combine_type_tfms[49m[43m([49m[43m)[49m[43m,[49m[43m [49m[43msplits[49m[38;5;241;43m=[39;49m[43msplits[49m[43m,[49m[43m [49m[43mdl_type[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdl_type[49m[43m,[49m[43m [49m[43mn_inp[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mn_inp[49m[43m,[49m[43m [49m[43mverbose[49m[38;5;241;43m=[39;49m[43mverbose[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:334[0m, in [0;36mDatasets.__init__[0;34m(self, items, tfms, tls, n_inp, dl_type, **kwargs)[0m
[1;32m    332[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, items[38;5;241m=[39m[38;5;28;01mNone[39;00m, tfms[38;5;241m=[39m[38;5;28;01mNone[39;00m, tls[38;5;241m=[39m[38;5;28;01mNone[39;00m, n_inp[38;5;241m=[39m[38;5;28;01mNone[39;00m, dl_type[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    333[0m     [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__init__[39m(dl_type[38;5;241m=[39mdl_type)
[0;32m--> 334[0m     [38;5;28mself[39m[38;5;241m.[39mtls [38;5;241m=[39m L(tls [38;5;28;01mif[39;00m tls [38;5;28;01melse[39;00m [TfmdLists(items, t, [38;5;241m*[39m[38;5;241m*[39mkwargs) [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m L(ifnone(tfms,[[38;5;28;01mNone[39;00m]))])
[1;32m    335[0m     [38;5;28mself[39m[38;5;241m.[39mn_inp [38;5;241m=[39m ifnone(n_inp, [38;5;28mmax[39m([38;5;241m1[39m, [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39mtls)[38;5;241m-[39m[38;5;241m1[39m))

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:334[0m, in [0;36m<listcomp>[0;34m(.0)[0m
[1;32m    332[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, items[38;5;241m=[39m[38;5;28;01mNone[39;00m, tfms[38;5;241m=[39m[38;5;28;01mNone[39;00m, tls[38;5;241m=[39m[38;5;28;01mNone[39;00m, n_inp[38;5;241m=[39m[38;5;28;01mNone[39;00m, dl_type[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    333[0m     [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__init__[39m(dl_type[38;5;241m=[39mdl_type)
[0;32m--> 334[0m     [38;5;28mself[39m[38;5;241m.[39mtls [38;5;241m=[39m L(tls [38;5;28;01mif[39;00m tls [38;5;28;01melse[39;00m [[43mTfmdLists[49m[43m([49m[43mitems[49m[43m,[49m[43m [49m[43mt[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m L(ifnone(tfms,[[38;5;28;01mNone[39;00m]))])
[1;32m    335[0m     [38;5;28mself[39m[38;5;241m.[39mn_inp [38;5;241m=[39m ifnone(n_inp, [38;5;28mmax[39m([38;5;241m1[39m, [38;5;28mlen[39m([38;5;28mself[39m[38;5;241m.[39mtls)[38;5;241m-[39m[38;5;241m1[39m))

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/foundation.py:97[0m, in [0;36m_L_Meta.__call__[0;34m(cls, x, *args, **kwargs)[0m
[1;32m     95[0m [38;5;28;01mdef[39;00m [38;5;21m__call__[39m([38;5;28mcls[39m, x[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m     96[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m args [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m kwargs [38;5;129;01mand[39;00m x [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m [38;5;28misinstance[39m(x,[38;5;28mcls[39m): [38;5;28;01mreturn[39;00m x
[0;32m---> 97[0m     [38;5;28;01mreturn[39;00m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__call__[39;49m[43m([49m[43mx[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:257[0m, in [0;36mTfmdLists.__init__[0;34m(self, items, tfms, use_list, do_setup, split_idx, train_setup, splits, types, verbose, dl_type)[0m
[1;32m    255[0m [38;5;28;01mif[39;00m do_setup:
[1;32m    256[0m     pv([38;5;124mf[39m[38;5;124m"[39m[38;5;124mSetting up [39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mtfms[38;5;132;01m}[39;00m[38;5;124m"[39m, verbose)
[0;32m--> 257[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msetup[49m[43m([49m[43mtrain_setup[49m[38;5;241;43m=[39;49m[43mtrain_setup[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/data/core.py:276[0m, in [0;36mTfmdLists.setup[0;34m(self, train_setup)[0m
[1;32m    275[0m [38;5;28;01mdef[39;00m [38;5;21msetup[39m([38;5;28mself[39m, train_setup[38;5;241m=[39m[38;5;28;01mTrue[39;00m):
[0;32m--> 276[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mtfms[49m[38;5;241;43m.[39;49m[43msetup[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mtrain_setup[49m[43m)[49m
[1;32m    277[0m     [38;5;28;01mif[39;00m [38;5;28mlen[39m([38;5;28mself[39m) [38;5;241m!=[39m [38;5;241m0[39m:
[1;32m    278[0m         x [38;5;241m=[39m [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__getitem__[39m([38;5;241m0[39m) [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39msplits [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m [38;5;28msuper[39m()[38;5;241m.[39m[38;5;21m__getitem__[39m([38;5;28mself[39m[38;5;241m.[39msplits[[38;5;241m0[39m])[[38;5;241m0[39m]

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/transform.py:192[0m, in [0;36mPipeline.setup[0;34m(self, items, train_setup)[0m
[1;32m    190[0m tfms [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mfs[:]
[1;32m    191[0m [38;5;28mself[39m[38;5;241m.[39mfs[38;5;241m.[39mclear()
[0;32m--> 192[0m [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m tfms: [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43madd[49m[43m([49m[43mt[49m[43m,[49m[43mitems[49m[43m,[49m[43m [49m[43mtrain_setup[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/transform.py:196[0m, in [0;36mPipeline.add[0;34m(self, ts, items, train_setup)[0m
[1;32m    194[0m [38;5;28;01mdef[39;00m [38;5;21madd[39m([38;5;28mself[39m,ts, items[38;5;241m=[39m[38;5;28;01mNone[39;00m, train_setup[38;5;241m=[39m[38;5;28;01mFalse[39;00m):
[1;32m    195[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m is_listy(ts): ts[38;5;241m=[39m[ts]
[0;32m--> 196[0m     [38;5;28;01mfor[39;00m t [38;5;129;01min[39;00m ts: [43mt[49m[38;5;241;43m.[39;49m[43msetup[49m[43m([49m[43mitems[49m[43m,[49m[43m [49m[43mtrain_setup[49m[43m)[49m
[1;32m    197[0m     [38;5;28mself[39m[38;5;241m.[39mfs[38;5;241m+[39m[38;5;241m=[39mts
[1;32m    198[0m     [38;5;28mself[39m[38;5;241m.[39mfs [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mfs[38;5;241m.[39msorted(key[38;5;241m=[39m[38;5;124m'[39m[38;5;124morder[39m[38;5;124m'[39m)

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/transform.py:79[0m, in [0;36mTransform.setup[0;34m(self, items, train_setup)[0m
[1;32m     77[0m [38;5;28;01mdef[39;00m [38;5;21msetup[39m([38;5;28mself[39m, items[38;5;241m=[39m[38;5;28;01mNone[39;00m, train_setup[38;5;241m=[39m[38;5;28;01mFalse[39;00m):
[1;32m     78[0m     train_setup [38;5;241m=[39m train_setup [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mtrain_setup [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;28;01melse[39;00m [38;5;28mself[39m[38;5;241m.[39mtrain_setup
[0;32m---> 79[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msetups[49m[43m([49m[38;5;28;43mgetattr[39;49m[43m([49m[43mitems[49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mtrain[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mitems[49m[43m)[49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mtrain_setup[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mitems[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastcore/dispatch.py:123[0m, in [0;36mTypeDispatch.__call__[0;34m(self, *args, **kwargs)[0m
[1;32m    121[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39minst [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m: f [38;5;241m=[39m MethodType(f, [38;5;28mself[39m[38;5;241m.[39minst)
[1;32m    122[0m [38;5;28;01melif[39;00m [38;5;28mself[39m[38;5;241m.[39mowner [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m: f [38;5;241m=[39m MethodType(f, [38;5;28mself[39m[38;5;241m.[39mowner)
[0;32m--> 123[0m [38;5;28;01mreturn[39;00m [43mf[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/text/core.py:285[0m, in [0;36mTokenizer.setups[0;34m(self, dsets)[0m
[1;32m    283[0m [38;5;28;01mdef[39;00m [38;5;21msetups[39m([38;5;28mself[39m, dsets):
[1;32m    284[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39mmode [38;5;241m==[39m [38;5;124m'[39m[38;5;124mdf[39m[38;5;124m'[39m [38;5;129;01mor[39;00m [38;5;129;01mnot[39;00m [38;5;28misinstance[39m(dsets[38;5;241m.[39mitems, pd[38;5;241m.[39mDataFrame): [38;5;28;01mreturn[39;00m
[0;32m--> 285[0m     dsets[38;5;241m.[39mitems,count [38;5;241m=[39m [43mtokenize_df[49m[43m([49m[43mdsets[49m[38;5;241;43m.[39;49m[43mitems[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mtext_cols[49m[43m,[49m[43m [49m[43mrules[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mrules[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mkwargs[49m[43m)[49m
[1;32m    286[0m     [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mcounter [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m: [38;5;28mself[39m[38;5;241m.[39mcounter [38;5;241m=[39m count
[1;32m    287[0m     [38;5;28;01mreturn[39;00m dsets

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/text/core.py:218[0m, in [0;36mtokenize_df[0;34m(df, text_cols, n_workers, rules, mark_fields, tok, tok_text_col)[0m
[1;32m    216[0m [38;5;28;01mif[39;00m mark_fields [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m: mark_fields [38;5;241m=[39m [38;5;28mlen[39m(text_cols)[38;5;241m>[39m[38;5;241m1[39m
[1;32m    217[0m rules [38;5;241m=[39m L(ifnone(rules, defaults[38;5;241m.[39mtext_proc_rules[38;5;241m.[39mcopy()))
[0;32m--> 218[0m texts [38;5;241m=[39m _join_texts([43mdf[49m[43m[[49m[43mtext_cols[49m[43m][49m, mark_fields[38;5;241m=[39mmark_fields)
[1;32m    219[0m outputs [38;5;241m=[39m L(parallel_tokenize(texts, tok, rules, n_workers[38;5;241m=[39mn_workers)
[1;32m    220[0m            )[38;5;241m.[39msorted()[38;5;241m.[39mitemgot([38;5;241m1[39m)
[1;32m    222[0m other_cols [38;5;241m=[39m df[38;5;241m.[39mcolumns[[38;5;241m~[39mdf[38;5;241m.[39mcolumns[38;5;241m.[39misin(text_cols)]

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/frame.py:3511[0m, in [0;36mDataFrame.__getitem__[0;34m(self, key)[0m
[1;32m   3509[0m     [38;5;28;01mif[39;00m is_iterator(key):
[1;32m   3510[0m         key [38;5;241m=[39m [38;5;28mlist[39m(key)
[0;32m-> 3511[0m     indexer [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcolumns[49m[38;5;241;43m.[39;49m[43m_get_indexer_strict[49m[43m([49m[43mkey[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mcolumns[39;49m[38;5;124;43m"[39;49m[43m)[49m[[38;5;241m1[39m]
[1;32m   3513[0m [38;5;66;03m# take() does not accept boolean indexers[39;00m
[1;32m   3514[0m [38;5;28;01mif[39;00m [38;5;28mgetattr[39m(indexer, [38;5;124m"[39m[38;5;124mdtype[39m[38;5;124m"[39m, [38;5;28;01mNone[39;00m) [38;5;241m==[39m [38;5;28mbool[39m:

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/indexes/base.py:5782[0m, in [0;36mIndex._get_indexer_strict[0;34m(self, key, axis_name)[0m
[1;32m   5779[0m [38;5;28;01melse[39;00m:
[1;32m   5780[0m     keyarr, indexer, new_indexer [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_reindex_non_unique(keyarr)
[0;32m-> 5782[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_raise_if_missing[49m[43m([49m[43mkeyarr[49m[43m,[49m[43m [49m[43mindexer[49m[43m,[49m[43m [49m[43maxis_name[49m[43m)[49m
[1;32m   5784[0m keyarr [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mtake(indexer)
[1;32m   5785[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(key, Index):
[1;32m   5786[0m     [38;5;66;03m# GH 42790 - Preserve name from an Index[39;00m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/pandas/core/indexes/base.py:5842[0m, in [0;36mIndex._raise_if_missing[0;34m(self, key, indexer, axis_name)[0m
[1;32m   5840[0m     [38;5;28;01mif[39;00m use_interval_msg:
[1;32m   5841[0m         key [38;5;241m=[39m [38;5;28mlist[39m(key)
[0;32m-> 5842[0m     [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mNone of [[39m[38;5;132;01m{[39;00mkey[38;5;132;01m}[39;00m[38;5;124m] are in the [[39m[38;5;132;01m{[39;00maxis_name[38;5;132;01m}[39;00m[38;5;124m][39m[38;5;124m"[39m)
[1;32m   5844[0m not_found [38;5;241m=[39m [38;5;28mlist[39m(ensure_index(key)[missing_mask[38;5;241m.[39mnonzero()[[38;5;241m0[39m]][38;5;241m.[39munique())
[1;32m   5845[0m [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00mnot_found[38;5;132;01m}[39;00m[38;5;124m not in index[39m[38;5;124m"[39m)

[0;31mKeyError[0m: "None of [Index(['text'], dtype='object')] are in the [columns]"
[IPKernelApp] Aborting queue
[IPKernelApp] Aborting 17ae97e9-fcc9-4283-a206-063168f0ae2c: execute_request
[IPKernelApp] Aborting 99b298fd-49e9-4c03-bad3-99dbd68019d3: execute_request
[IPKernelApp] Aborting 9310acae-5a2d-4294-a89b-f1dc123b7a04: execute_request
[IPKernelApp] Aborting 0dcc61e4-fb33-499c-90d3-20bd5ebccf02: execute_request
[IPKernelApp] Aborting e3a0d708-8a92-429a-8192-22e6bdc07fa3: execute_request
[IPKernelApp] Aborting 2a471ab6-6d63-4ac0-9546-4e56bd3814d7: execute_request
[IPKernelApp] Aborting dab0b32a-de18-4b22-b73d-691ea32c365f: execute_request
[IPKernelApp] Aborting 373ab983-6214-4239-8bb0-34ba9fc880fd: execute_request
[IPKernelApp] Aborting b3cdecb3-5bfd-4196-a8c6-ad5d337d7d36: execute_request
[IPKernelApp] Aborting b3ffc43f-2861-443e-b7f4-e23ff97039ba: execute_request
[IPKernelApp] Aborting 253d4ffa-a2ae-43e1-819f-88c4b7382444: execute_request
[IPKernelApp] Aborting 8ae28e80-6edd-4cfe-933a-dbe5d114ae38: execute_request
[IPKernelApp] Aborting 40c23cdb-b3b8-4097-b828-acff81a34887: execute_request
[IPKernelApp] Aborting 95de1cb9-7a6e-477a-add0-22b30e57d952: execute_request
[IPKernelApp] Aborting 987f5cf1-309b-449a-a263-e8e0eec870e2: execute_request
[IPKernelApp] Aborting 1aaba96f-cf17-44c0-aa9d-8095a74b4f20: execute_request
[IPKernelApp] Aborting 7ab8c132-e42b-4303-ac71-dba426dcd16d: execute_request
[IPKernelApp] Aborting 54e654df-2bcd-4663-bc74-6f0c901a0500: execute_request
[IPKernelApp] Finishing abort
[IPKernelApp] Exception in execute request:
[0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
Input [0;32mIn [97][0m, in [0;36m<cell line: 1>[0;34m()[0m
[0;32m----> 1[0m learn [38;5;241m=[39m [43mlearn[49m[38;5;241;43m.[39;49m[43mload_encoder[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mfinetuned_lm_stack_exc[39;49m[38;5;124;43m'[39;49m[43m)[49m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/fastai/text/learner.py:105[0m, in [0;36mTextLearner.load_encoder[0;34m(self, file, device)[0m
[1;32m    103[0m distrib_barrier()
[1;32m    104[0m wgts [38;5;241m=[39m torch[38;5;241m.[39mload(join_path_file(file,[38;5;28mself[39m[38;5;241m.[39mpath[38;5;241m/[39m[38;5;28mself[39m[38;5;241m.[39mmodel_dir, ext[38;5;241m=[39m[38;5;124m'[39m[38;5;124m.pth[39m[38;5;124m'[39m), map_location[38;5;241m=[39mdevice)
[0;32m--> 105[0m [43mencoder[49m[38;5;241;43m.[39;49m[43mload_state_dict[49m[43m([49m[43mclean_raw_keys[49m[43m([49m[43mwgts[49m[43m)[49m[43m)[49m
[1;32m    106[0m [38;5;28mself[39m[38;5;241m.[39mfreeze()
[1;32m    107[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m

File [0;32m/work/08791/hsingh24/ls6/miniconda3/envs/pt/lib/python3.8/site-packages/torch/nn/modules/module.py:1497[0m, in [0;36mModule.load_state_dict[0;34m(self, state_dict, strict)[0m
[1;32m   1492[0m         error_msgs[38;5;241m.[39minsert(
[1;32m   1493[0m             [38;5;241m0[39m, [38;5;124m'[39m[38;5;124mMissing key(s) in state_dict: [39m[38;5;132;01m{}[39;00m[38;5;124m. [39m[38;5;124m'[39m[38;5;241m.[39mformat(
[1;32m   1494[0m                 [38;5;124m'[39m[38;5;124m, [39m[38;5;124m'[39m[38;5;241m.[39mjoin([38;5;124m'[39m[38;5;124m"[39m[38;5;132;01m{}[39;00m[38;5;124m"[39m[38;5;124m'[39m[38;5;241m.[39mformat(k) [38;5;28;01mfor[39;00m k [38;5;129;01min[39;00m missing_keys)))
[1;32m   1496[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(error_msgs) [38;5;241m>[39m [38;5;241m0[39m:
[0;32m-> 1497[0m     [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m([38;5;124m'[39m[38;5;124mError(s) in loading state_dict for [39m[38;5;132;01m{}[39;00m[38;5;124m:[39m[38;5;130;01m\n[39;00m[38;5;130;01m\t[39;00m[38;5;132;01m{}[39;00m[38;5;124m'[39m[38;5;241m.[39mformat(
[1;32m   1498[0m                        [38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m, [38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;130;01m\t[39;00m[38;5;124m"[39m[38;5;241m.[39mjoin(error_msgs)))
[1;32m   1499[0m [38;5;28;01mreturn[39;00m _IncompatibleKeys(missing_keys, unexpected_keys)

[0;31mRuntimeError[0m: Error(s) in loading state_dict for AWD_LSTM:
	size mismatch for encoder.weight: copying a param with shape torch.Size([1912, 400]) from checkpoint, the shape in current model is torch.Size([60008, 400]).
	size mismatch for encoder_dp.emb.weight: copying a param with shape torch.Size([1912, 400]) from checkpoint, the shape in current model is torch.Size([60008, 400]).
[IPKernelApp] Aborting queue
[IPKernelApp] Aborting f7be1682-a08c-4880-8235-cce4b7c0efa0: execute_request
[IPKernelApp] Aborting e86b9728-ee64-42c5-a2f8-e2b0b5097b1d: execute_request
[IPKernelApp] Aborting 3f7ab8ac-4090-4a68-adfc-80529d8259d3: execute_request
[IPKernelApp] Aborting ee7f2859-c050-4bec-862f-c1599164d72f: execute_request
[IPKernelApp] Aborting 2a1d73a7-f296-4b11-b77d-2b87dff6ad25: execute_request
[IPKernelApp] Finishing abort
